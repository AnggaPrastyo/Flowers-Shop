<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Riwayat Pesanan - Flowers Shop</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;1,700&display=swap"
      rel="stylesheet"
    />

    <!-- My style -->
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/riwayat-pesanan.css" />
  </head>
  <body>
    <!--navbar-->
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
      <div class="container-fluid">
        <!-- Logo dengan class tambahan untuk positioning -->
        <a class="navbar-brand mobile-brand" href="index.html"
          >Flowers <span>Shop</span></a
        >

        <!-- Wadah untuk icon mobile dan toggle -->
        <div class="d-flex align-items-center">
          <!-- Icon-icon mobile (hanya tampil di mobile) -->
          <div class="mobile-icons d-flex d-lg-none align-items-center">
            <a href="#" class="nav-link position-relative mx-1">
              <i class="bi bi-search fs-5"></i>
            </a>
            <a href="keranjang.html" class="nav-link position-relative mx-1">
              <i class="bi bi-cart2 fs-5"></i>
              <span class="badge-keranjang">0</span>
            </a>
            <a href="login.html" class="nav-link mx-1" id="mobile-login">
              <i class="bi bi-person-circle fs-5"></i>
            </a>
          </div>

          <!-- Toggle button -->
          <button
            class="navbar-toggler ms-2"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarTogglerDemo02"
            aria-controls="navbarTogglerDemo02"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
        </div>

        <!-- Navbar content yang collapse -->
        <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
          <ul class="navbar-nav mx-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" aria-current="page" href="index.html#Beranda"
                >Beranda</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="index.html#Produk">Produk</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="kategori.html">Kategori</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="index.html#Tentang-Kami"
                >Tentang Kami</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="index.html#Kontak">Kontak</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Pembayaran</a>
            </li>
          </ul>

          <!-- Icon-icon desktop (hanya tampil di desktop) -->
          <div class="navbar-extra d-none d-lg-flex align-items-center">
            <a href="#" class="nav-link position-relative mx-2">
              <i class="bi bi-search fs-4"></i>
            </a>
            <a href="keranjang.html" class="nav-link position-relative mx-2">
              <i class="bi bi-cart2 fs-4"></i>
              <span class="badge-keranjang">0</span>
            </a>
            <!-- Gunakan sistem logic untuk menampilkan tombol login ATAU profil dropdown -->
            <div id="user-container">
              <!-- Tombol login (tampil saat belum login) -->
              <a href="login.html" class="nav-link ms-2" id="tombol-login">
                <i class="bi bi-person-circle fs-4"></i>
              </a>

              <!-- Dropdown user (tampil saat sudah login) -->
              <div class="dropdown ms-2" id="tombol-user" style="display: none">
                <a href="#" class="nav-link dropdown-toggle" role="button">
                  <i class="bi bi-person-fill fs-4"></i>
                </a>
                <div class="dropdown-menu dropdown-menu-end">
                  <div class="dropdown-item fw-bold nama-user">Pengguna</div>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="profil-pengguna.html"
                    >Profil Saya</a
                  >
                  <a class="dropdown-item active" href="riwayat-pesanan.html"
                    >Pesanan Saya</a
                  >
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="#" id="tombol-logout"
                    >Logout</a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nav>
    <!--navbar end-->

    <!-- Riwayat Pesanan Section -->
    <section class="order-history-section">
      <div class="container">
        <div class="row">
          <div class="col-lg-3">
            <div class="user-sidebar">
              <div class="user-profile-card">
                <div class="user-avatar">
                  <i class="bi bi-person-circle"></i>
                </div>
                <div class="user-info">
                  <h5 class="user-name" id="sidebar-user-name">Pengguna</h5>
                  <p class="user-email" id="sidebar-user-email">
                    user@example.com
                  </p>
                </div>
              </div>

              <div class="sidebar-menu">
                <a href="profil-pengguna.html" class="sidebar-link">
                  <i class="bi bi-person"></i>
                  <span>Profil Saya</span>
                </a>
                <a href="riwayat-pesanan.html" class="sidebar-link active">
                  <i class="bi bi-bag"></i>
                  <span>Pesanan Saya</span>
                </a>
                <a href="#" class="sidebar-link" id="sidebar-logout">
                  <i class="bi bi-box-arrow-right"></i>
                  <span>Logout</span>
                </a>
              </div>
            </div>
          </div>

          <div class="col-lg-9">
            <div class="content-card">
              <div class="card-header">
                <h3>Riwayat Pesanan</h3>
              </div>

              <div class="filter-orders">
                <div class="row align-items-center">
                  <div class="col-md-6">
                    <select id="filter-status" class="form-select">
                      <option value="all">Semua Status</option>
                      <option value="pending">Menunggu Pembayaran</option>
                      <option value="processing">Diproses</option>
                      <option value="shipped">Dikirim</option>
                      <option value="completed">Selesai</option>
                      <option value="cancelled">Dibatalkan</option>
                    </select>
                  </div>
                  <div class="col-md-6">
                    <div class="input-group">
                      <input
                        type="text"
                        id="search-order"
                        class="form-control"
                        placeholder="Cari pesanan..."
                      />
                      <button class="btn btn-primary" type="button">
                        <i class="bi bi-search"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Daftar Pesanan -->
              <div id="order-list">
                <!-- Pesanan akan ditampilkan disini dengan JavaScript -->

                <!-- Contoh Pesanan 1 -->
                <div class="order-item" data-status="processing">
                  <div class="order-header">
                    <div class="order-info">
                      <div class="order-id">#FS2505001</div>
                      <div class="order-date">12 Mei 2025</div>
                    </div>
                    <div class="order-status processing">Diproses</div>
                  </div>

                  <div class="order-products">
                    <div class="product-item">
                      <div class="product-image">
                        <img src="img/Produk/bunga.jpeg" alt="Bunga Mawar" />
                      </div>
                      <div class="product-details">
                        <div class="product-name">Bunga Mawar</div>
                        <div class="product-price">Rp 100.000</div>
                        <div class="product-quantity">x2</div>
                      </div>
                    </div>
                  </div>

                  <div class="order-footer">
                    <div class="order-total">
                      <span>Total Pesanan:</span>
                      <span class="total-amount">Rp 215.000</span>
                    </div>
                    <div class="order-actions">
                      <button
                        class="btn btn-sm btn-outline-primary"
                        onclick="viewOrderDetail('FS2505001')"
                      >
                        Detail
                      </button>
                      <button
                        class="btn btn-sm btn-primary"
                        onclick="trackOrder('FS2505001')"
                      >
                        Lacak
                      </button>
                    </div>
                  </div>
                </div>

                <!-- Contoh Pesanan 2 -->
                <div class="order-item" data-status="pending">
                  <div class="order-header">
                    <div class="order-info">
                      <div class="order-id">#FS2504232</div>
                      <div class="order-date">10 Mei 2025</div>
                    </div>
                    <div class="order-status pending">Menunggu Pembayaran</div>
                  </div>

                  <div class="order-products">
                    <div class="product-item">
                      <div class="product-image">
                        <img src="img/Produk/bunga4.jpeg" alt="Bunga Lily" />
                      </div>
                      <div class="product-details">
                        <div class="product-name">Bunga Lily</div>
                        <div class="product-price">Rp 120.000</div>
                        <div class="product-quantity">x1</div>
                      </div>
                    </div>
                  </div>

                  <div class="order-footer">
                    <div class="order-total">
                      <span>Total Pesanan:</span>
                      <span class="total-amount">Rp 145.000</span>
                    </div>
                    <div class="order-actions">
                      <button
                        class="btn btn-sm btn-outline-primary"
                        onclick="viewOrderDetail('FS2504232')"
                      >
                        Detail
                      </button>
                      <button
                        class="btn btn-sm btn-primary"
                        onclick="payNow('FS2504232')"
                      >
                        Bayar Sekarang
                      </button>
                    </div>
                  </div>
                </div>

                <!-- Contoh Pesanan 3 -->
                <div class="order-item" data-status="completed">
                  <div class="order-header">
                    <div class="order-info">
                      <div class="order-id">#FS2504200</div>
                      <div class="order-date">5 Mei 2025</div>
                    </div>
                    <div class="order-status completed">Selesai</div>
                  </div>

                  <div class="order-products">
                    <div class="product-item">
                      <div class="product-image">
                        <img
                          src="img/Produk/bunga5.jpeg"
                          alt="Bunga Matahari"
                        />
                      </div>
                      <div class="product-details">
                        <div class="product-name">Bunga Matahari</div>
                        <div class="product-price">Rp 95.000</div>
                        <div class="product-quantity">x3</div>
                      </div>
                    </div>
                    <div class="more-items">+2 produk lainnya</div>
                  </div>

                  <div class="order-footer">
                    <div class="order-total">
                      <span>Total Pesanan:</span>
                      <span class="total-amount">Rp 355.000</span>
                    </div>
                    <div class="order-actions">
                      <button
                        class="btn btn-sm btn-outline-primary"
                        onclick="viewOrderDetail('FS2504200')"
                      >
                        Detail
                      </button>
                      <button
                        class="btn btn-sm btn-outline-success"
                        onclick="addReview('FS2504200')"
                      >
                        Beri Ulasan
                      </button>
                    </div>
                  </div>
                </div>

                <!-- Contoh Pesanan 4 -->
                <div class="order-item" data-status="shipped">
                  <div class="order-header">
                    <div class="order-info">
                      <div class="order-id">#FS2504195</div>
                      <div class="order-date">3 Mei 2025</div>
                    </div>
                    <div class="order-status shipped">Dikirim</div>
                  </div>

                  <div class="order-products">
                    <div class="product-item">
                      <div class="product-image">
                        <img src="img/Produk/Bunga1.jpg" alt="Bunga Tulip" />
                      </div>
                      <div class="product-details">
                        <div class="product-name">Bunga Tulip</div>
                        <div class="product-price">Rp 150.000</div>
                        <div class="product-quantity">x1</div>
                      </div>
                    </div>
                  </div>

                  <div class="order-footer">
                    <div class="order-total">
                      <span>Total Pesanan:</span>
                      <span class="total-amount">Rp 175.000</span>
                    </div>
                    <div class="order-actions">
                      <button
                        class="btn btn-sm btn-outline-primary"
                        onclick="viewOrderDetail('FS2504195')"
                      >
                        Detail
                      </button>
                      <button
                        class="btn btn-sm btn-primary"
                        onclick="trackOrder('FS2504195')"
                      >
                        Lacak
                      </button>
                    </div>
                  </div>
                </div>

                <!-- Contoh Pesanan 5 -->
                <div class="order-item" data-status="cancelled">
                  <div class="order-header">
                    <div class="order-info">
                      <div class="order-id">#FS2504180</div>
                      <div class="order-date">1 Mei 2025</div>
                    </div>
                    <div class="order-status cancelled">Dibatalkan</div>
                  </div>

                  <div class="order-products">
                    <div class="product-item">
                      <div class="product-image">
                        <img src="img/Produk/Bunga2.jpg" alt="Bunga Anggrek" />
                      </div>
                      <div class="product-details">
                        <div class="product-name">Bunga Anggrek</div>
                        <div class="product-price">Rp 200.000</div>
                        <div class="product-quantity">x1</div>
                      </div>
                    </div>
                  </div>

                  <div class="order-footer">
                    <div class="order-total">
                      <span>Total Pesanan:</span>
                      <span class="total-amount">Rp 225.000</span>
                    </div>
                    <div class="order-actions">
                      <button
                        class="btn btn-sm btn-outline-primary"
                        onclick="viewOrderDetail('FS2504180')"
                      >
                        Detail
                      </button>
                      <button
                        class="btn btn-sm btn-primary"
                        onclick="orderAgain('FS2504180')"
                      >
                        Pesan Lagi
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Pagination -->
              <div class="pagination-container">
                <nav aria-label="Page navigation">
                  <ul class="pagination justify-content-center">
                    <li class="page-item disabled">
                      <a
                        class="page-link"
                        href="#"
                        tabindex="-1"
                        aria-disabled="true"
                      >
                        <i class="bi bi-chevron-left"></i>
                      </a>
                    </li>
                    <li class="page-item active">
                      <a class="page-link" href="#">1</a>
                    </li>
                    <li class="page-item">
                      <a class="page-link" href="#">2</a>
                    </li>
                    <li class="page-item">
                      <a class="page-link" href="#">
                        <i class="bi bi-chevron-right"></i>
                      </a>
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Modal Detail Pesanan -->
    <div
      class="modal fade"
      id="orderDetailModal"
      tabindex="-1"
      aria-labelledby="orderDetailModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="orderDetailModalLabel">
              Detail Pesanan #<span id="modal-order-id">FS2505001</span>
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <div class="row mb-4">
              <div class="col-md-6">
                <h6 class="detail-section-title">Informasi Pesanan</h6>
                <table class="table table-borderless detail-table">
                  <tr>
                    <td>Nomor Pesanan</td>
                    <td>: <span id="detail-order-id">FS2505001</span></td>
                  </tr>
                  <tr>
                    <td>Tanggal Pemesanan</td>
                    <td>: <span id="detail-order-date">12 Mei 2025</span></td>
                  </tr>
                  <tr>
                    <td>Status</td>
                    <td>
                      :
                      <span id="detail-order-status" class="badge bg-info"
                        >Diproses</span
                      >
                    </td>
                  </tr>
                  <tr>
                    <td>Metode Pembayaran</td>
                    <td>
                      :
                      <span id="detail-payment-method"
                        >Transfer Bank (BCA)</span
                      >
                    </td>
                  </tr>
                </table>
              </div>
              <div class="col-md-6">
                <h6 class="detail-section-title">Informasi Pengiriman</h6>
                <table class="table table-borderless detail-table">
                  <tr>
                    <td>Nama Penerima</td>
                    <td>
                      : <span id="detail-recipient-name">Anita Susanti</span>
                    </td>
                  </tr>
                  <tr>
                    <td>Alamat</td>
                    <td>
                      :
                      <span id="detail-address"
                        >Jl. Sultan Alimuddin No. 123, Samarinda Seberang</span
                      >
                    </td>
                  </tr>
                  <tr>
                    <td>Telepon</td>
                    <td>: <span id="detail-phone">08123456789</span></td>
                  </tr>
                  <tr>
                    <td>Kurir</td>
                    <td>: <span id="detail-courier">Kurir Toko</span></td>
                  </tr>
                </table>
              </div>
            </div>

            <h6 class="detail-section-title">Detail Produk</h6>
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th>Produk</th>
                    <th>Harga</th>
                    <th>Jumlah</th>
                    <th>Total</th>
                  </tr>
                </thead>
                <tbody id="detail-products">
                  <tr>
                    <td>
                      <div class="d-flex align-items-center gap-2">
                        <img
                          src="img/Produk/bunga.jpeg"
                          alt="Bunga Mawar"
                          width="50"
                          height="50"
                          class="rounded"
                        />
                        <span>Bunga Mawar</span>
                      </div>
                    </td>
                    <td>Rp 100.000</td>
                    <td>2</td>
                    <td>Rp 200.000</td>
                  </tr>
                </tbody>
                <tfoot>
                  <tr>
                    <td colspan="3" class="text-end fw-bold">Subtotal:</td>
                    <td id="detail-subtotal">Rp 200.000</td>
                  </tr>
                  <tr>
                    <td colspan="3" class="text-end fw-bold">Ongkos Kirim:</td>
                    <td id="detail-shipping">Rp 15.000</td>
                  </tr>
                  <tr>
                    <td colspan="3" class="text-end fw-bold">Total:</td>
                    <td id="detail-total" class="fw-bold">Rp 215.000</td>
                  </tr>
                </tfoot>
              </table>
            </div>

            <div id="order-timeline" class="mt-4">
              <h6 class="detail-section-title">Status Pengiriman</h6>
              <div class="timeline">
                <div class="timeline-item active">
                  <div class="timeline-point"></div>
                  <div class="timeline-content">
                    <div class="timeline-date">12 Mei 2025, 08:30</div>
                    <div class="timeline-title">Pesanan Dibuat</div>
                    <div class="timeline-desc">
                      Pesanan berhasil dibuat, menunggu pembayaran
                    </div>
                  </div>
                </div>
                <div class="timeline-item active">
                  <div class="timeline-point"></div>
                  <div class="timeline-content">
                    <div class="timeline-date">12 Mei 2025, 09:15</div>
                    <div class="timeline-title">Pembayaran Diterima</div>
                    <div class="timeline-desc">
                      Pembayaran telah dikonfirmasi
                    </div>
                  </div>
                </div>
                <div class="timeline-item active">
                  <div class="timeline-point"></div>
                  <div class="timeline-content">
                    <div class="timeline-date">12 Mei 2025, 10:30</div>
                    <div class="timeline-title">Pesanan Diproses</div>
                    <div class="timeline-desc">Pesanan sedang disiapkan</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-point"></div>
                  <div class="timeline-content">
                    <div class="timeline-date">-</div>
                    <div class="timeline-title">Dalam Pengiriman</div>
                    <div class="timeline-desc">
                      Pesanan dalam perjalanan ke alamat anda
                    </div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-point"></div>
                  <div class="timeline-content">
                    <div class="timeline-date">-</div>
                    <div class="timeline-title">Pesanan Selesai</div>
                    <div class="timeline-desc">Pesanan telah diterima</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Tutup
            </button>
            <button type="button" class="btn btn-primary" id="btn-action-order">
              Lacak Pesanan
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Ulasan -->
    <div
      class="modal fade"
      id="reviewModal"
      tabindex="-1"
      aria-labelledby="reviewModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="reviewModalLabel">Beri Ulasan</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="review-form">
              <div class="mb-3">
                <label for="product-select" class="form-label"
                  >Pilih Produk</label
                >
                <select class="form-select" id="product-select" required>
                  <option value="" selected disabled>
                    Pilih produk untuk diulas
                  </option>
                  <option value="1">Bunga Mawar</option>
                  <option value="2">Bunga Lily</option>
                  <option value="3">Bunga Matahari</option>
                </select>
              </div>

              <div class="mb-3">
                <label class="form-label">Rating</label>
                <div class="star-rating">
                  <i class="bi bi-star rating-star" data-rating="1"></i>
                  <i class="bi bi-star rating-star" data-rating="2"></i>
                  <i class="bi bi-star rating-star" data-rating="3"></i>
                  <i class="bi bi-star rating-star" data-rating="4"></i>
                  <i class="bi bi-star rating-star" data-rating="5"></i>
                  <input
                    type="hidden"
                    id="rating-value"
                    name="rating"
                    value="0"
                  />
                </div>
              </div>

              <div class="mb-3">
                <label for="review-text" class="form-label">Ulasan Anda</label>
                <textarea
                  class="form-control"
                  id="review-text"
                  rows="3"
                  placeholder="Bagikan pengalaman Anda dengan produk ini"
                  required
                ></textarea>
              </div>

              <div class="mb-3">
                <label for="review-image" class="form-label"
                  >Unggah Foto (Opsional)</label
                >
                <input
                  class="form-control"
                  type="file"
                  id="review-image"
                  accept="image/*"
                />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Batal
            </button>
            <button type="button" class="btn btn-primary" id="submit-review">
              Kirim Ulasan
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="js/script.js"></script>
    <script src="js/keranjang.js"></script>
    <script src="js/perbaikan-keranjang.js"></script>
    <script src="js/fix-keranjang-links.js"></script>
    <script src="js/riwayat-pesanan.js"></script>
  </body>
</html>
